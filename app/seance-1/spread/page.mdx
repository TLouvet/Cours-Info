# Spread Operator (...)

**Essentiel pour l'immutabilit√© !**

Le spread operator `...` permet de "d√©plier" les √©l√©ments d'un tableau ou d'un objet.

## Avec les tableaux

### Fusionner des tableaux

```javascript
const arr1 = [1, 2];
const arr2 = [3, 4];

const merged = [...arr1, ...arr2];
console.log(merged); // [1, 2, 3, 4]
```

### Copier un tableau

```javascript
const original = [1, 2, 3];
const copy = [...original];

console.log(copy); // [1, 2, 3]
console.log(copy === original); // false (nouvelle r√©f√©rence)
```

### Ajouter des √©l√©ments

```javascript
const arr1 = [1, 2, 3];

// Au d√©but
const extended = [0, ...arr1]; // [0, 1, 2, 3]

// √Ä la fin
const extended = [...arr1, 4, 5]; // [1, 2, 3, 4, 5]

// Au milieu
const extended = [...arr1.slice(0, 2), 99, ...arr1.slice(2)];
// [1, 2, 99, 3]
```

<Callout type="tip" title="Immutabilit√©">
Le spread operator permet de cr√©er de nouvelles copies au lieu de modifier les originaux. C'est une pratique essentielle en programmation moderne.

```javascript
// ‚ùå Mutation directe
const numbers = [1, 2, 3];
numbers.push(4);
console.log(numbers); // [1, 2, 3, 4] - modifi√©

// ‚úÖ Immutabilit√© avec spread
const numbers = [1, 2, 3];
const newNumbers = [...numbers, 4];
console.log(numbers);    // [1, 2, 3] - inchang√© ‚úÖ
console.log(newNumbers); // [1, 2, 3, 4]
```
</Callout>

## Avec les objets

### Copier un objet

```javascript
const user = { name: 'Alice', age: 25 };

const copy = { ...user };
console.log(copy); // { name: 'Alice', age: 25 }
```

### Modifier une propri√©t√©

```javascript
const user = { name: 'Alice', age: 25 };

const updated = { ...user, age: 26 };
console.log(updated); // { name: 'Alice', age: 26 }
console.log(user);    // { name: 'Alice', age: 25 } (inchang√© ‚úÖ)
```

### Fusionner des objets

```javascript
const person = { name: 'Bob', age: 30 };
const address = { city: 'Paris', country: 'France' };

const complete = { ...person, ...address };
console.log(complete);
// { name: 'Bob', age: 30, city: 'Paris', country: 'France' }
```

### Ordre important

```javascript
const user = { name: 'Alice', age: 25 };

// Les propri√©t√©s apr√®s √©crasent les pr√©c√©dentes
const updated1 = { ...user, age: 26 };
// { name: 'Alice', age: 26 }

const updated2 = { age: 26, ...user };
// { age: 25, name: 'Alice' } (user.age √©crase 26)
```

## Exemples pratiques

### Ajouter un √©l√©ment √† un tableau

```javascript
const items = [1, 2, 3];

// Ajouter √† la fin
const withFour = [...items, 4];
console.log(withFour); // [1, 2, 3, 4]

// Ajouter au d√©but
const withZero = [0, ...items];
console.log(withZero); // [0, 1, 2, 3]
```

### Retirer un √©l√©ment d'un tableau

```javascript
const items = [1, 2, 3, 4, 5];

// Retirer par index
const removeAtIndex = (arr, index) => {
  return [
    ...arr.slice(0, index),
    ...arr.slice(index + 1)
  ];
};

console.log(removeAtIndex(items, 2)); // [1, 2, 4, 5]

// Retirer par valeur
const removeValue = (arr, value) => {
  return arr.filter(item => item !== value);
};

console.log(removeValue(items, 3)); // [1, 2, 4, 5]
```

### Modifier un √©l√©ment dans un tableau

```javascript
const todos = [
  { id: 1, text: 'Apprendre JavaScript', done: false },
  { id: 2, text: 'Faire les courses', done: false }
];

// Marquer un todo comme termin√©
const toggleTodo = (todos, id) => {
  return todos.map(todo =>
    todo.id === id
      ? { ...todo, done: !todo.done }
      : todo
  );
};

console.log(toggleTodo(todos, 1));
// [{ id: 1, text: 'Apprendre JavaScript', done: true }, ...]
```

### Mettre √† jour un objet imbriqu√©

```javascript
const user = {
  name: 'Alice',
  address: {
    city: 'Paris',
    country: 'France'
  }
};

// Changer la ville (spread √† chaque niveau)
const updatedUser = {
  ...user,
  address: {
    ...user.address,
    city: 'Lyon'
  }
};

console.log(updatedUser.address.city); // 'Lyon'
console.log(user.address.city);        // 'Paris' (inchang√© ‚úÖ)
```

<Callout type="warning" title="Shallow copy (copie superficielle)">
Le spread operator fait une **copie superficielle** (shallow copy). Les objets imbriqu√©s sont partag√©s par r√©f√©rence :

```javascript
const user = {
  name: 'Alice',
  address: { city: 'Paris' }
};

const copy = { ...user };
copy.address.city = 'Lyon';

console.log(user.address.city); // 'Lyon' (modifi√© aussi! üò±)
```

**Solutions :**

1. **Utiliser le spread √† chaque niveau** (manuel)
```javascript
const copy = {
  ...user,
  address: { ...user.address }
};
copy.address.city = 'Lyon';
console.log(user.address.city); // 'Paris' (inchang√© ‚úÖ)
```

2. **Utiliser `structuredClone()`** (moderne, recommand√©)
```javascript
const copy = structuredClone(user);
copy.address.city = 'Lyon';
console.log(user.address.city); // 'Paris' (inchang√© ‚úÖ)
```

`structuredClone()` fait une **copie profonde** (deep copy) de tout l'objet, y compris les objets imbriqu√©s. C'est la solution la plus simple et la plus s√ªre pour copier des objets complexes.

**Limites de `structuredClone()` :**
- Ne copie pas les fonctions
- Ne copie pas les symboles
- Ne copie pas les prototypes

Pour la plupart des cas d'usage (donn√©es JSON, objets simples), `structuredClone()` est parfait.
</Callout>

## Rest vs Spread

M√™me syntaxe `...` mais usages diff√©rents :

```javascript
// Spread : d√©plier
const arr = [1, 2, 3];
console.log(...arr); // 1 2 3

// Rest : collecter
const [first, ...rest] = arr;
console.log(first); // 1
console.log(rest);  // [2, 3]
```

